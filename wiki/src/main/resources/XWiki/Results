<?xml version="1.0" encoding="ISO-8859-1"?>

<xwikidoc>
<web>XWiki</web>
<name>Results</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent></parent>
<creator>XWiki.Admin</creator>
<author>XWiki.Admin</author>
<customClass></customClass>
<contentAuthor>XWiki.Admin</contentAuthor>
<creationDate>1158300067000</creationDate>
<date>1180527554000</date>
<contentUpdateDate>1180527554000</contentUpdateDate>
<version>1.4</version>
<title></title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment></comment>
<object>
<class>
<name>XWiki.TagClass</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<tags>
<name>tags</name>
<prettyName>Tags</prettyName>
<unmodifiable>0</unmodifiable>
<relationalStorage>1</relationalStorage>
<displayType>input</displayType>
<multiSelect>1</multiSelect>
<size>30</size>
<separator> </separator>
<cache>0</cache>
<separators> ,|</separators>
<values></values>
<number>1</number>
<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
</tags>
</class>
<name>XWiki.Results</name>
<number>0</number>
<className>XWiki.TagClass</className>
<property>
<tags/>
</property>
</object>
<content>#set($showdata = 0)
#set($formatDate = "yyyy MMMM dd, HH:mm")

## WARNING: Do not add any empty line inside the table element. This will potentially break 
## the Javascript we're using for filtering/sorting columns. It might work in FF but will break
## in other browsers like IE. This is because empty lines add &lt;p class="paragraph"&gt;&lt;/p&gt; elements
## when rendered.

&lt;table id="searchTableUnique" class="grid sortable filterable doOddEven"&gt;
  &lt;tr class="sortHeader"&gt;
    &lt;th&gt;Page&lt;/th&gt;
    &lt;th style="width:150px" class="selectFilter"&gt;Space&lt;/th&gt;
    &lt;th style="width:150px"&gt;Date&lt;/th&gt;
    &lt;th style="width:150px"&gt;Last Author&lt;/th&gt;
    #if($xwiki.hasAdminRights())
      &lt;th style="width:210px" class="unsortable noFilter"&gt;Actions&lt;/th&gt;
    #end
  &lt;/tr&gt;
  #foreach ($item in $list)
    #set($troubi ="non")
      #if ($xwiki.hasAccessLevel("view", $context.user, "${context.database}:${item}"))
        #set($bentrydoc = $xwiki.getDocument($item))
        #set($cclass = $xwiki.getDocument("XWiki.XWikiComments").getxWikiClass())
        #set($comment = $cclass.newObject())
        #if($xwiki.getWebPreferenceAsInt("commentsorder",1)==0)
          #set($comments = $bentrydoc.getComments())
        #else
          #set($comments = $bentrydoc.getComments(false))
        #end
        #set($createur = $xwiki.getUserName($bentrydoc.author))
        #set($ptitle = $bentrydoc.getDisplayTitle())
        &lt;tr&gt;&lt;td style="text-align:left"&gt;
          #if($comments.size()&gt;0)  
            #set($i = 0)  
            #set($cobj = $comments.get($i))  
            #set($comment = $bentrydoc.display("comment", "view", $cobj))  
            #set($date = $cobj.getXWikiObject().get("date").value)
            #if($date)
              #set($date2 = $!xwiki.formatDate($date,"yyyy MM dd HH:mm:ss")  )
            #end
            #if($bentrydoc)
              #set($date1 = $!xwiki.formatDate($!bentrydoc.date,"yyyy MM dd HH:mm:ss") )
            #end
            #if($date1.equals($date2) )
              [$ptitle&gt;${bentrydoc.web}.$bentrydoc.name] &lt;em&gt;- 1 new comment&lt;/em&gt;
              #set($troubi ="oui")
              #set($desc = $cobj.getXWikiObject().get("comment").value)
            #else
              [$bentrydoc.name&gt;${bentrydoc.web}.$bentrydoc.name] #if ($ptitle != $bentrydoc.name) &lt;em&gt;- $ptitle&lt;/em&gt;#end
            #end
          #else  
            #set($comment = "")  
            [$bentrydoc.name&gt;${bentrydoc.web}.$bentrydoc.name.replaceAll("@","%40")] #if ($ptitle != $bentrydoc.name) &lt;em&gt;- $ptitle&lt;/em&gt;#end
          #end   
        &lt;/td&gt;&lt;td style="text-align:left"&gt;
          [$bentrydoc.web&gt;${bentrydoc.web}.WebHome]
        &lt;/td&gt;&lt;td style="text-align:left"&gt;
          $xwiki.formatDate($bentrydoc.date,"yyyy MMM dd") at $xwiki.formatDate($bentrydoc.date,"HH:mm")&lt;/td&gt;&lt;td style="text-align:center"&gt;
          #if($troubi =="oui")
            #set($createur = $xwiki.getUserName($cobj.author)   )
          #end
          #if ($createur == "XWikiGuest")
            Guest
          #else
            $createur
          #end
        &lt;/td&gt;
        #if($xwiki.hasAdminRights())
          &lt;td&gt;
            &lt;a href="$xwiki.getURL("XWiki.CopyDocument", "view", "sourcedoc=${bentrydoc.fullName}")"&gt;Copy&lt;/a&gt; - &lt;a href="$bentrydoc.getURL("delete")"&gt;Delete&lt;/a&gt; - &lt;a href="$bentrydoc.getURL("view", "xpage=rename&amp;amp;step=1")"&gt;Rename&lt;/a&gt; - &lt;a href="$bentrydoc.getURL("edit", "editor=rights")"&gt;Rights&lt;/a&gt;
          &lt;/td&gt;
        #end
      &lt;/tr&gt;
    #end
  #end
&lt;/table&gt;
</content></xwikidoc>